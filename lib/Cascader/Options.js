var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)},__read=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,a=t.call(e),o=[];try{for(;(void 0===r||0<r--)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(i)throw i.error}}return o},__spreadArray=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,i=0,a=r.length;i<a;i++)!n&&i in r||((n=n||Array.prototype.slice.call(r,0,i))[i]=r[i]);return e.concat(n||Array.prototype.slice.call(r))},__values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};import{jsx as _jsx,jsxs as _jsxs}from"react/jsx-runtime";import React from"react";import ListItem from"@mui/material/ListItem";import Typography from"@mui/material/ListItem";import ExpandIcon from"./ExpandIcon";import Check from"../TreeSelect/Check";export default function(e){var i=e.dense,r=e.parentId,a=e.showCheck,t=e.search,o=e.multiple,l=e.selected,s=e.inputValue,c=e.flatOptions,d=e.setSelected,u=e.allChildrenMap,n=e.setFlattedOptions,f=e.loadData,p=e.openChildren,e=__read(React.useState(null),2),_=e[0],h=e[1],m=function(r){o?l.includes(r.id)?d(l.filter(function(e){return e!==r.id})):d(__spreadArray(__spreadArray([],__read(l),!1),[r.id],!1)):d([r.id])},y=function(t){f&&(h(t.id),f(t).then(function(r){n(c.map(function(e){return e.id===t.id?__assign(__assign({},e),{children:r}):e}).concat(r.map(function(e){return __assign(__assign({},e),{parentId:t.id})}))),p(t.id)}).finally(function(){h(null)}))};return e=c.filter(function(e){return e.parentId===r}),(e=t&&s?function(e){var r,t,n=[];try{for(var i=__values(u.entries()),a=i.next();!a.done;a=i.next()){var o=__read(a.value,2),l=o[0];o[1].filter(function(e){return-1<"".concat(e.name).indexOf(s)}).length&&n.push(l)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return e.filter(function(e){return n.includes(e.id)||-1<"".concat(e.name).indexOf(s)})}(e):e).map(function(e){return r=e,e=!!c.find(function(e){return e.parentId===r.id}),t=l.includes(r.id),n=_===r.id,_jsxs(ListItem,__assign({dense:i,sx:{cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},selected:t,secondaryAction:_jsx(ExpandIcon,{loadData:f,hasChildren:e,isLoading:n,openChildren:function(){return p(r.id)},startLoadData:function(){return y(r)}}),onClick:function(e){o&&e.stopPropagation(),m(r)}},{children:[_jsx(Check,{option:r,show:a,selected:l,setSelected:d,allChildrenMap:u}),_jsx(Typography,{children:r.name})]}),r.id);var r,t,n})}