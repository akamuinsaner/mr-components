var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),l=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)l.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return l},__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};import{jsx as _jsx,jsxs as _jsxs}from"react/jsx-runtime";import React from"react";import{IconButton,Popper,DialogActions,DialogContent,Button,Checkbox,FormControlLabel,FormGroup,Autocomplete,TextField,Stack}from"@mui/material";import FilterAltIcon from"@mui/icons-material/FilterAlt";import styles from"./index.module.css";import{MRTableContext}from".";import classNames from"classnames";export default function(e){function t(){d(null),document.removeEventListener("click",t),document.body.click()}var n=e.column,r=e.index,o=e.value,i=e.onChange,e=e.children,l=React.useContext(MRTableContext).filterInfo,a=null!=l&&l.filters?null==l?void 0:l.filters(n,r):n.filters,s=null!=l&&l.filterMode?null==l?void 0:l.filterMode(n,r):n.filterMode,c=__read(React.useState([]),2),u=c[0],p=c[1],c=__read(React.useState(null),2),f=c[0],d=c[1],m=(React.useEffect(function(){p(o||[])},[o]),React.useEffect(function(){f&&document.addEventListener("click",t)},[f]),{width:"200px"}),c={open:!!f,anchorEl:f,placement:"bottom-end",className:styles["mr-table-filter-popper"],onClick:function(e){return e.stopPropagation()}},_=(null!=l&&l.popperProps&&(c="function"==typeof l.popperProps?Object.assign({},c,l.popperProps(n,r)):Object.assign({},c,l.popperProps)),FilterAltIcon),h={fontSize:"small",className:classNames(styles["mr-table-filter-icon"])};return null!=l&&l.filterIcon&&(_=l.filterIcon(n,r)),o&&o.length&&(h=Object.assign({},h,{htmlColor:"#1976d2"})),_jsxs(Stack,__assign({justifyContent:"space-between",direction:"row"},{children:[e,_jsx(IconButton,__assign({size:"small",sx:{float:"right",padding:0},onClick:function(e){e.stopPropagation(),d(e.currentTarget)}},{children:_jsx(_,__assign({},h))})),_jsxs(Popper,__assign({},c,{children:[_jsx(DialogContent,{children:function(){switch(s){case"input":return _jsx(TextField,{value:u[0],onChange:function(e){return p([e.target.value])},size:"small",sx:m,placeholder:"please input"});case"autoComplete":return _jsx(Autocomplete,{multiple:!0,options:a,renderInput:function(e){return _jsx(TextField,__assign({},e,{placeholder:"please select"}))},getOptionKey:function(e){return e.id},getOptionLabel:function(e){return e.name},size:"small",sx:m,value:a.filter(function(e){return u.includes(e.id)}),onChange:function(e,t){return p(t.map(function(e){return e.id}))}});default:return _jsx(FormGroup,{children:a.map(function(t){return _jsx(FormControlLabel,{control:_jsx(Checkbox,{checked:u.includes(t.id),onChange:function(e){e.target.checked?p(__spreadArray(__spreadArray([],__read(u),!1),[t.id],!1)):p(u.filter(function(e){return e!==t.id}))}}),label:t.name},t.id)})})}}()}),_jsxs(DialogActions,{children:[_jsx(Button,__assign({size:"small",variant:"text",disabled:!u.length,onClick:function(e){e.stopPropagation(),p([])}},{children:"reset"})),_jsx(Button,__assign({size:"small",variant:"contained",onClick:function(e){e.stopPropagation(),i(u),t()}},{children:"confirm"}))]})]}))]}))}