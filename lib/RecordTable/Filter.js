var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),l=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)l.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return l},__spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import React from"react";import{IconButton,Popper,DialogActions,DialogContent,Button,Checkbox,FormControlLabel,FormGroup,Autocomplete,TextField}from"@mui/material";import FilterAltIcon from"@mui/icons-material/FilterAlt";import styles from"../index.module.css";import{MRTableContext}from".";export default function(e){var t,n,r,o,i,l,a,s,c,u=e.column,p=e.index,f=e.value,d=e.onChange,e=React.useContext(MRTableContext).filterInfo,_=null!=e&&e.filters?null==e?void 0:e.filters(u,p):u.filters;return _?(t=null!=e&&e.filterMode?null==e?void 0:e.filterMode(u,p):u.filterMode,s=__read(React.useState([]),2),n=s[0],r=s[1],s=__read(React.useState(null),2),o=s[0],i=s[1],React.useEffect(function(){f&&r(f)},[f]),l=function(){i(null),document.removeEventListener("click",l),document.body.click()},React.useEffect(function(){o&&document.addEventListener("click",l)},[o]),a={width:"200px"},s={open:!!o,anchorEl:o,placement:"bottom-end",className:styles["mr-table-filter-popper"],onClick:function(e){return e.stopPropagation()}},null!=e&&e.popperProps&&(s="function"==typeof e.popperProps?Object.assign({},s,e.popperProps(u,p)):Object.assign({},s,e.popperProps)),c=FilterAltIcon,null!=e&&e.filterIcon&&(c=e.filterIcon(u,p)),_jsxs(_Fragment,{children:[_jsx(IconButton,__assign({size:"small",sx:{float:"right"},onClick:function(e){e.stopPropagation(),i(e.currentTarget)}},{children:_jsx(c,{fontSize:"small"})})),_jsxs(Popper,__assign({},s,{children:[_jsx(DialogContent,{children:function(){switch(t){case"input":return _jsx(TextField,{value:n[0],onChange:function(e){return r([e.target.value])},size:"small",sx:a,placeholder:"please input"});case"autoComplete":return _jsx(Autocomplete,{multiple:!0,options:_,renderInput:function(e){return _jsx(TextField,__assign({},e,{placeholder:"please select"}))},getOptionKey:function(e){return e.id},getOptionLabel:function(e){return e.name},size:"small",sx:a,value:_.filter(function(e){return n.includes(e.id)}),onChange:function(e,t){return r(t.map(function(e){return e.id}))}});default:return _jsx(FormGroup,{children:_.map(function(t){return _jsx(FormControlLabel,{control:_jsx(Checkbox,{checked:n.includes(t.id),onChange:function(e){e.target.checked?r(__spreadArray(__spreadArray([],__read(n),!1),[t.id],!1)):r(n.filter(function(e){return e!==t.id}))}}),label:t.name},t.id)})})}}()}),_jsxs(DialogActions,{children:[_jsx(Button,__assign({size:"small",variant:"text",disabled:!n.length,onClick:function(e){e.stopPropagation(),r([])}},{children:"reset"})),_jsx(Button,__assign({size:"small",variant:"contained",onClick:function(e){e.stopPropagation(),d(n),l()}},{children:"confirm"}))]})]}))]})):null}