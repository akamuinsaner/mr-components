var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r}).apply(this,arguments)},__read=this&&this.__read||function(r,e){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var t,i,a=n.call(r),o=[];try{for(;(void 0===e||0<e--)&&!(t=a.next()).done;)o.push(t.value)}catch(r){i={error:r}}finally{try{t&&!t.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o},__spreadArray=this&&this.__spreadArray||function(r,e,n){if(n||2===arguments.length)for(var t,i=0,a=e.length;i<a;i++)!t&&i in e||((t=t||Array.prototype.slice.call(e,0,i))[i]=e[i]);return r.concat(t||Array.prototype.slice.call(e))},__values=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&r[e],t=0;if(n)return n.call(r);if(r&&"number"==typeof r.length)return{next:function(){return{value:(r=r&&t>=r.length?void 0:r)&&r[t++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};import{jsx as _jsx,jsxs as _jsxs}from"react/jsx-runtime";import React from"react";import ListItem from"@mui/material/ListItem";import Typography from"@mui/material/ListItem";import Check from"./Check";import ExpandIcon from"./ExpandIcon";export default function(r){function u(e,d){void 0===e&&(e=""),void 0===d&&(d=0);var r=y.filter(function(r){return r.parentId===e});return n&&l&&(r=function(r){var e,n,t=[];try{for(var i=__values(g.entries()),a=i.next();!a.done;a=i.next()){var o=__read(a.value,2),s=o[0];o[1].filter(function(r){return-1<"".concat(r.name).indexOf(l)}).length&&t.push(s)}}catch(r){e={error:r}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r.filter(function(r){return t.includes(r.id)||-1<"".concat(r.name).indexOf(l)})}(r)),__spreadArray([],__read(r.map(function(e){var n,r,t,i,a,o=y.filter(function(r){return r.parentId===e.id}),s=o&&o.length,l=j[e.id],c=[(n=e,c=d,o=o,r=h.includes(n.id),o=o&&o.length,t=j[n.id],i=x===n.id,a=o||!!v,_jsxs(ListItem,__assign({sx:{paddingLeft:"".concat(20*c+16,"px"),cursor:"pointer"},dense:_,selected:r,onClick:function(r){p&&r.stopPropagation(),b(n)}},{children:[_jsx(ExpandIcon,{hasChildren:o,showChildren:t,isLoading:i,visibility:a,toggleOpen:function(r){return A(n.id,r)},startLoadData:function(){return I(n)}}),_jsx(Check,{option:n,show:f,selected:h,setSelected:m,allChildrenMap:g}),_jsx(Typography,{children:n.name})]}),n.id))];return c=l&&s?__spreadArray(__spreadArray([],__read(c),!1),__read(u(e.id,d+1)),!1):c})),!1)}var _=r.dense,t=r.expandKeys,e=r.expandAll,f=r.showCheck,n=r.search,p=r.multiple,h=r.selected,l=r.inputValue,y=r.flatOptions,m=r.setSelected,g=r.allChildrenMap,i=r.setFlattedOptions,v=r.loadData,r=__read(React.useState(null),2),x=r[0],a=r[1],r=__read(React.useState({}),2),j=r[0],o=r[1],b=(React.useEffect(function(){e?o(y.reduce(function(r,e){return __assign(__assign({},r),((r={})[e.id]=!0,r))},{})):t&&t.length&&o(y.reduce(function(r,e){var n;return t.includes(e.id)?__assign(__assign({},r),((n={})[e.id]=!0,n)):r},{}))},[e,t,y]),function(e){p?h.includes(e.id)?m(h.filter(function(r){return r!==e.id})):m(__spreadArray(__spreadArray([],__read(h),!1),[e.id],!1)):m([e.id])}),A=function(r,e){var n;o(__assign(__assign({},j),((n={})[r]=e,n)))},I=function(n){v&&(a(n.id),v(n).then(function(e){i(y.map(function(r){return r.id===n.id?__assign(__assign({},r),{children:e}):r}).concat(e.map(function(r){return __assign(__assign({},r),{parentId:n.id})}))),A(n.id,!0)}).finally(function(){a(null)}))};return u()}